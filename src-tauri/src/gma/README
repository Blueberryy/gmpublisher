This has been heavily adapted from https://github.com/wyozi/steamws/tree/master/src/gma with thanks to Wyozi
